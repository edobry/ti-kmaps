prgmKSETDIR
1→F
While [I](Y,X)!=2 and F<33
If D=1:Then
If X+M<9 and X+M>0:Then
X+MX
Else:((M=1)(1)+(M=-1)(8))→X:
Id Y=4 or Y=1:Then
((M=1 and K!=0)(1)+(M=-1)(4)+(K=0 and Y=1)(2)+(K=0 and Y=4)(1))→Y
Else:Y+M→Y:End
End
End
If D=0:Then
If Y+M>0 and Y+M<5:Then
Y+M→Y
Else:((M=1)(1)+(M=-1)(4))→Y
End
End
F+1→F
If F>32:prgmKDONE
End
prgmSETPOS